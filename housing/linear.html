<!DOCTYPE html>
<html>
<head>
  <title>TensorFlow.js linear regression</title>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs/dist/tf.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-vis"></script>
</head>
<body>

  <script type="text/javascript">

    const plot = (pointsArray, featureName) => {
      tfvis.render.scatterplot(
        { name: `${featureName} vs House Price`},
        { values: [pointsArray], series: ['original'] },
        {
          xLabel: featureName,
          yLabel: "Price"
        }
      )
    }

    const run = async () => {
      const salesData = tf.data.csv("http://127.0.0.1:8080/housing/kc_house_data.csv");
      const sampleData = salesData.take(10);
      const arrayData = await sampleData.toArray();
      console.log(arrayData);

      const points = salesData.map(record => ({
        x: record.sqft_living,
        y: record.price
      }))
      plot(await points.toArray(), "square feet")

      // inputs (features)
      const featureValues = await points.map(p => p.x).toArray()
      const featureTensor = tf.tensor2d(featureValues, [featureValues.length, 1])

      // outputs (labels)
      const labelValues = await points.map(p => p.y).toArray()
      const labelTensor = tf.tensor2d(labelValues, [labelValues.length, 1])

      featureTensor.print()
      labelTensor.print()

    }

    run();

  </script>

</body>
</html>
